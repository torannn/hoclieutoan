<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Học Liệu Tương Tác: Quy Hoạch Tuyến Tính</title>
    
    <!-- MathJax Configuration -->
    <script>
        window.MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']]
            },
            output: {
                font: 'mathjax-pagella'
            },
            startup: {
                ready: () => {
                    console.log('MathJax is ready!');
                    MathJax.startup.defaultReady();
                    if (window.updateMath) window.updateMath();
                }
            }
        };
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@4/tex-mml-chtml.js" id="MathJax-script" async></script>
    <link href="https://fonts.googleapis.com/css2?family=Lora:ital,wght@0,400..700;1,400..700&display=swap" rel="stylesheet">
    
    <!-- Custom Styles -->
    <style>
        :root {
            --primary-color: #007bff;
            --secondary-color: #6c757d;
            --danger-color: #dc3545;
            --success-color: #28a745;
            --warning-color: #ffc107;
            --background-color: #f4f7f9;
            --text-color: #333;
            --slide-bg-color: #ffffff;
            --slide-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            --border-radius: 8px;
            --highlight-pastel-color: rgba(255, 204, 204, 0.9); /* Pastel Red */
        }

        body {
            font-family: 'Lora', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            font-weight: 500;
            font-size: 18px;
            line-height: 1.7;
            margin: 0;
            padding: 2rem;
            background-color: var(--background-color);
            color: var(--text-color);
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
        }

        .main-container {
            max-width: 900px;
            width: 100%;
        }

        .slide {
            display: none;
            background-color: var(--slide-bg-color);
            border-radius: var(--border-radius);
            box-shadow: var(--slide-shadow);
            padding: 2rem 2.5rem;
            margin-bottom: 1.5rem;
            border-left: 5px solid var(--primary-color);
        }
        
        .slide.active {
            display: block;
        }

        .problem-statement {
            background-color: #f8f9fa;
            border-left: 5px solid #ccc;
            margin: 0 0 1.5em 0;
            padding: 1em 1.5em;
            font-style: italic;
            border-radius: var(--border-radius);
            line-height: 2;
        }

        .highlight-pastel {
            background-color: var(--highlight-pastel-color);
            padding: 2px 5px;
            border-radius: 3px;
            transition: background-color 0.3s ease;
        }

        .processed {
            text-decoration: line-through;
            color: #adb5bd;
            background-color: transparent !important;
        }

        h1, h2, h3 {
            color: var(--primary-color);
            margin-top: 0;
        }

        h2 {
            border-bottom: 2px solid #eee;
            padding-bottom: 0.5rem;
            margin-bottom: 1.5rem;
        }

        strong, b {
            color: var(--danger-color);
            font-weight: 700;
        }

        .navigation {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem;
            background-color: var(--slide-bg-color);
            border-radius: var(--border-radius);
            box-shadow: var(--slide-shadow);
        }

        .nav-button {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 12px 24px;
            font-size: 16px;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s, transform 0.2s;
        }
        .nav-button:hover {
            background-color: #0056b3;
            transform: translateY(-2px);
        }
        .nav-button:disabled {
            background-color: #a0c9ff;
            cursor: not-allowed;
            transform: none;
        }

        .slide-counter {
            font-size: 16px;
            color: var(--secondary-color);
            font-weight: 600;
        }
        
        .exercise-input-group {
            margin: 1.5rem 0;
            display: flex;
            flex-direction: column;
        }
        .exercise-input-group label {
            margin-bottom: 0.5rem;
            font-weight: 600;
        }
        .exercise-input-group input[type="text"] {
            padding: 10px;
            font-size: 16px;
            border: 2px solid #ccc;
            border-radius: 5px;
            font-family: 'Lora', sans-serif;
        }
        .exercise-input-group input[type="text"]::placeholder {
            color: #aaa;
            font-style: italic;
        }
        .exercise-input-group input[type="text"].correct {
            border-color: var(--success-color);
            background-color: #e9f7ef;
        }
        .exercise-input-group input[type="text"].incorrect {
            border-color: var(--danger-color);
            background-color: #fbe9e9;
        }
        
        .radio-option {
            padding: 8px 12px;
            border: 2px solid #ddd;
            border-radius: 5px;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            cursor: pointer;
            transition: all 0.2s ease-in-out;
        }
        .radio-option:hover {
            background-color: #f8f9fa;
        }
        .radio-option input {
            margin-right: 12px;
        }
        .radio-option.correct {
            border-color: var(--success-color);
            background-color: #e9f7ef;
        }
        .radio-option.incorrect {
            border-color: var(--danger-color);
            background-color: #fbe9e9;
        }
        
        .feedback-message {
            margin-top: 1rem;
            padding: 1rem;
            border-radius: 5px;
            text-align: center;
            font-weight: 600;
            display: none;
        }
        .feedback-message.success {
            background-color: #d4edda;
            color: #155724;
        }
        .feedback-message.error {
            background-color: #f8d7da;
            color: #721c24;
        }

        .hint-button {
            background-color: var(--warning-color);
            color: #333;
            margin-right: 1rem;
        }
        .hint-button:hover {
            background-color: #e0a800;
        }

        .hint-content {
            background-color: #fffbe6;
            border: 1px dashed var(--warning-color);
            padding: 1rem;
            margin-top: 1rem;
            border-radius: 5px;
            font-style: italic;
        }
        
        .exercise-buttons {
            margin-top: 1.5rem;
        }

    </style>
</head>
<body>

    <div class="main-container">
        <h1 style="text-align:center; margin-bottom: 2rem;">Học Liệu Tương Tác: Quy Hoạch Tuyến Tính</h1>
        
        <div id="problem1-statement-display" class="problem-statement" style="display: none;">
            Người ta định dùng hai loại nguyên liệu để chiết xuất <span id="p1_req_A">ít nhất 120 kg</span> hóa chất A và <span id="p1_req_B">9 kg</span> hóa chất B. Từ mỗi tấn <span id="p1_type_1">nguyên liệu loại I</span> giá <span id="p1_cost_1">4 triệu đồng</span> có thể chiết xuất được <span id="p1_yield_A1">20 kg chất A</span> và <span id="p1_yield_B1">0,6 kg chất B</span>. Từ mỗi tấn <span id="p1_type_2">nguyên liệu loại II</span> giá <span id="p1_cost_2">3 triệu đồng</span> có thể chiết xuất được <span id="p1_yield_A2">10 kg chất A</span> và <span id="p1_yield_B2">1,5 kg chất B</span>. Hỏi phải dùng <span id="p1_variables">bao nhiêu tấn nguyên liệu mỗi loại</span> để <span id="p1_objective">chi phí mua nguyên liệu là ít nhất</span>. Biết rằng cơ sở cung cấp nguyên liệu chỉ có thể cung cấp <span id="p1_limit_1">không quá 10 tấn</span> nguyên liệu loại I và <span id="p1_limit_2">không quá 9 tấn</span> nguyên liệu loại II.
        </div>

        <div id="problem2-statement-display" class="problem-statement" style="display: none;">
             Một xưởng sản xuất <span id="p2_products">hai loại sản phẩm A và B</span>. Để sản xuất <span id="p2_product_A">1 sản phẩm A</span> cần <span id="p2_labor_A">2 giờ lao động</span> và <span id="p2_material_A">1kg nguyên liệu</span>; <span id="p2_product_B">1 sản phẩm B</span> cần <span id="p2_labor_B">1 giờ lao động</span> và <span id="p2_material_B">2kg nguyên liệu</span>. Xưởng có tối đa <span id="p2_limit_labor">10 giờ lao động</span> và <span id="p2_limit_material">8kg nguyên liệu</span> mỗi ngày. <span id="p2_profit_A">Lợi nhuận mỗi sản phẩm A là 3 triệu đồng</span>, <span id="p2_profit_B">mỗi sản phẩm B là 2 triệu đồng</span>. Hỏi mỗi ngày xưởng nên <span id="p2_variables">sản xuất bao nhiêu sản phẩm mỗi loại</span> để <span id="p2_objective">lợi nhuận lớn nhất</span>?
        </div>
        
        <div id="slides-container"></div>

        <div class="navigation">
            <button id="prevBtn" class="nav-button">Trang trước</button>
            <span id="slideCounter" class="slide-counter"></span>
            <button id="nextBtn" class="nav-button">Trang sau</button>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // --- CONFIGURATION ---
            const slidesConfig = [
                // === Problem 1 ===
                {
                    problem: 1,
                    title: 'Bắt đầu: Đặt biến số',
                    content: `<h3>Mục tiêu: Xác định các ẩn số của bài toán.</h3>
                    <p>Câu hỏi của bài toán là: "Hỏi phải dùng <strong>bao nhiêu tấn nguyên liệu mỗi loại</strong>...". Đây chính là thứ chúng ta cần tìm.</p>
                    <p>Hãy đặt:</p>
                    <ul>
                        <li>$x$ là số tấn nguyên liệu <strong>loại I</strong>.</li>
                        <li>$y$ là số tấn nguyên liệu <strong>loại II</strong>.</li>
                    </ul>
                    <p>Vì số lượng không thể âm, ta luôn có điều kiện ban đầu: $x \\ge 0, y \\ge 0$.</p>`,
                    highlights: { current: ['p1_variables', 'p1_type_1', 'p1_type_2'] }
                },
                {
                    problem: 1,
                    title: 'Xây dựng Hàm mục tiêu',
                    content: `<h3>Mục tiêu: Viết biểu thức cho đại lượng cần tối ưu.</h3>
                    <p>Bài toán yêu cầu "<strong>chi phí mua nguyên liệu là ít nhất</strong>". Đây là mục tiêu cần tối ưu (tìm min).</p>
                    <ul>
                        <li>Giá nguyên liệu loại I là <strong>4 triệu/tấn</strong> $\\implies$ Chi phí cho $x$ tấn là $4x$.</li>
                        <li>Giá nguyên liệu loại II là <strong>3 triệu/tấn</strong> $\\implies$ Chi phí cho $y$ tấn là $3y$.</li>
                    </ul>
                    <p>Vậy, hàm mục tiêu (tổng chi phí) là: $F(x, y) = 4x + 3y \\rightarrow \\min$</p>`,
                    highlights: { current: ['p1_objective', 'p1_cost_1', 'p1_cost_2'], processed: ['p1_variables', 'p1_type_1', 'p1_type_2'] }
                },
                {
                    problem: 1,
                    title: 'Ràng buộc về Hóa chất A',
                    content: `<h3>Mục tiêu: Lập bất phương trình từ các giới hạn.</h3>
                    <p>Ta cần chiết xuất "<strong>ít nhất 120 kg</strong>" hóa chất A, nghĩa là tổng lượng hóa chất A $\\ge 120$.</p>
                    <ul>
                        <li>Từ $x$ tấn loại I, thu được: $20x$ kg chất A.</li>
                        <li>Từ $y$ tấn loại II, thu được: $10y$ kg chất A.</li>
                    </ul>
                    <p>Tổng cộng, ta có bất phương trình: $20x + 10y \\ge 120$ (hay $2x + y \\ge 12$).</p>`,
                    highlights: { current: ['p1_req_A', 'p1_yield_A1', 'p1_yield_A2'], processed: ['p1_objective', 'p1_cost_1', 'p1_cost_2'] }
                },
                {
                    problem: 1,
                    title: 'Ràng buộc về Hóa chất B',
                    content: `<h3>Mục tiêu: Tiếp tục lập các bất phương trình.</h3>
                    <p>Tương tự, ta cần "<strong>ít nhất 9 kg</strong>" hóa chất B, nghĩa là tổng lượng hóa chất B $\\ge 9$.</p>
                    <ul>
                        <li>Từ $x$ tấn loại I, thu được: $0.6x$ kg chất B.</li>
                        <li>Từ $y$ tấn loại II, thu được: $1.5y$ kg chất B.</li>
                    </ul>
                    <p>Tổng cộng, ta có: $0.6x + 1.5y \\ge 9$ (hay $2x + 5y \\ge 30$).</p>`,
                    highlights: { current: ['p1_req_B', 'p1_yield_B1', 'p1_yield_B2'], processed: ['p1_req_A', 'p1_yield_A1', 'p1_yield_A2'] }
                },
                {
                    problem: 1,
                    title: 'Ràng buộc về Nguồn cung',
                    content: `<h3>Mục tiêu: Hoàn thành các ràng buộc còn lại.</h3>
                    <p>Cơ sở cung cấp có giới hạn:</p>
                    <ul>
                        <li>"<strong>không quá 10 tấn</strong>" nguyên liệu loại I $\\implies x \\le 10$.</li>
                        <li>"<strong>không quá 9 tấn</strong>" nguyên liệu loại II $\\implies y \\le 9$.</li>
                    </ul>`,
                    highlights: { current: ['p1_limit_1', 'p1_limit_2'], processed: ['p1_req_B', 'p1_yield_B1', 'p1_yield_B2'] }
                },
                {
                    problem: 1,
                    title: 'Tổng kết Mô hình Toán học',
                    content: `<h3>Mục tiêu: Ghép nối thành một hệ hoàn chỉnh.</h3>
                    <p>Tất cả các thông tin trong đề bài đã được xử lý. Mô hình toán học của chúng ta là:</p>
                    <p>Tìm $x, y$ để $F(x, y) = 4x + 3y \\rightarrow \\min$ với các điều kiện:</p>
                    <div class="math-system" style="text-align: left; padding-left: 2rem;">
                    $$
                    \\begin{cases}
                      2x + y \\ge 12 \\\\
                      2x + 5y \\ge 30 \\\\
                      x \\le 10 \\\\
                      y \\le 9 \\\\
                      x \\ge 0, y \\ge 0
                    \\end{cases}
                    $$
                    </div>`,
                    highlights: { processed: ['p1_limit_1', 'p1_limit_2'] }
                },
                // === Transition Slide ===
                {
                    problem: 2,
                    title: 'Đến lượt bạn luyện tập!',
                    content: `<h3 style="text-align:center;">Bây giờ, hãy áp dụng những gì đã học để giải một bài toán mới nhé!</h3>
                              <p style="text-align:center; font-size: 1.1em;">Hãy đọc kĩ đề bài và hoàn thành các bước mô hình hoá sau đây.</p>`,
                    highlights: {}
                },
                // === Problem 2 ===
                {
                    problem: 2,
                    title: 'Bài tập: Đặt biến số',
                    content: `<h3>Lượt của bạn: Hãy xác định các ẩn số.</h3>
                    <p>Dựa vào câu hỏi, hãy chọn đáp án đúng cho các biến.</p>
                    <div class="exercise-input-group">
                        <label>Biến $x$ là:</label>
                        <label class="radio-option"><input type="radio" name="var_x" value="correct"> Số sản phẩm loại A (đơn vị: sản phẩm)</label>
                        <label class="radio-option"><input type="radio" name="var_x" value="wrong1"> Số giờ lao động để sản xuất sản phẩm loại A (đơn vị: giờ)</label>
                        <label class="radio-option"><input type="radio" name="var_x" value="wrong2"> Số kg nguyên liệu để làm sản phẩm A (đơn vị: kg)</label>
                        <label class="radio-option"><input type="radio" name="var_x" value="wrong3"> Lợi nhuận của sản phẩm loại A (đơn vị: triệu đồng)</label>
                    </div>
                    <div class="exercise-input-group">
                        <label>Biến $y$ là:</label>
                        <label class="radio-option"><input type="radio" name="var_x" value="correct"> Số sản phẩm loại B (đơn vị: sản phẩm)</label>
                        <label class="radio-option"><input type="radio" name="var_x" value="wrong1"> Số giờ lao động để sản xuất sản phẩm loại B (đơn vị: giờ)</label>
                        <label class="radio-option"><input type="radio" name="var_x" value="wrong2"> Số kg nguyên liệu để làm sản phẩm B (đơn vị: kg)</label>
                        <label class="radio-option"><input type="radio" name="var_x" value="wrong3"> Lợi nhuận của sản phẩm loại B (đơn vị: triệu đồng)</label>
                    </div>
                    <div id="hint-8" class="hint-content" style="display: none;">
                        <strong>Gợi ý:</strong> Hãy đọc kĩ câu hỏi cuối cùng của bài toán: "...sản xuất <strong>bao nhiêu sản phẩm mỗi loại</strong>...". Biến số chính là đại lượng mà bài toán yêu cầu chúng ta tìm kiếm.
                    </div>`,
                    highlights: { current: ['p2_variables', 'p2_products'] },
                    isExercise: true,
                    answers: { var_x: "correct", var_y: "correct" }
                },
                {
                    problem: 2,
                    title: 'Bài tập: Hàm mục tiêu',
                    content: `<h3>Lượt của bạn: Xây dựng hàm mục tiêu.</h3>
                    <p>Xác định biểu thức lợi nhuận và mục tiêu cần tối ưu.</p>
                     <div class="exercise-input-group">
                        <label for="objective_expr">Biểu thức lợi nhuận $F(x,y)$:</label>
                        <div style="display: flex; align-items: center;">
                           <input type="text" id="objective_expr" placeholder="...x + ...y"> 
                           <span style="margin-left: 10px; font-weight: 600;">(triệu đồng)</span>
                        </div>
                    </div>
                    <div class="exercise-input-group">
                        <label>Mục tiêu:</label>
                        <label class="radio-option"><input type="radio" name="objective_goal" value="max"> $\\rightarrow \\max$</label>
                        <label class="radio-option"><input type="radio" name="objective_goal" value="min"> $\\rightarrow \\min$</label>
                    </div>
                    <div id="hint-9" class="hint-content" style="display: none;">
                        <strong>Gợi ý:</strong> 1 sản phẩm A lời 3 triệu đồng, vậy $x$ sản phẩm A lời được ... 1 sản phẩm B lời được 2 triệu đồng, vậy $y$ sản phẩm B lời được ...
                    </div>`,
                    highlights: { current: ['p2_objective', 'p2_profit_A', 'p2_profit_B'], processed: ['p2_variables', 'p2_products'] },
                    isExercise: true,
                    answers: { objective_expr: "3x+2y", objective_goal: "max" }
                },
                {
                    problem: 2,
                    title: 'Bài tập: Các ràng buộc',
                    content: `<h3>Lượt của bạn: Viết các bất phương trình ràng buộc.</h3>
                    <p>Viết các bất phương trình cho giờ lao động và nguyên liệu.</p>
                     <div class="exercise-input-group">
                        <label for="constraint_1">Ràng buộc về giờ lao động:</label>
                        <input type="text" id="constraint_1" placeholder="Gợi ý: ...x + ...y <= ...">
                    </div>
                     <div class="exercise-input-group">
                        <label for="constraint_2">Ràng buộc về nguyên liệu:</label>
                        <input type="text" id="constraint_2" placeholder="Gợi ý: ...x + ...y <= ...">
                    </div>
                    <div id="hint-10" class="hint-content" style="display: none;">
                        <strong>Gợi ý:</strong> 1 sản phẩm A cần 2 giờ lao động và 1kg nguyên liệu. $x$ sản phẩm A cần ? giờ lao động và ? kg nguyên liệu.\n1 sản phẩm B cần 1 giờ lao động và 2kg nguyên liệu. $y$ sản phẩm B cần ? giờ lao động và ? kg nguyên liệu.
                    </div>`,
                    highlights: { current: ['p2_labor_A', 'p2_labor_B', 'p2_material_A', 'p2_material_B', 'p2_limit_labor', 'p2_limit_material'], processed: ['p2_objective', 'p2_profit_A', 'p2_profit_B'] },
                    isExercise: true,
                    answers: { constraint_1: "2x+y<=10", constraint_2: "x+2y<=8" }
                },
                {
                    problem: 2,
                    title: 'Tổng kết Mô hình Bài tập',
                    content: `<h3>Chúc mừng! Bạn đã hoàn thành mô hình.</h3>
                    <p>Đây là mô hình toán học hoàn chỉnh cho bài toán thứ hai:</p>
                    <p>Tìm $x, y$ để $F(x, y) = 3x + 2y \\rightarrow \\max$ với các điều kiện:</p>
                     <div class="math-system" style="text-align: left; padding-left: 2rem;">
                    $$
                    \\begin{cases}
                      2x + y \\le 10 \\\\
                      x + 2y \\le 8 \\\\
                      x \\ge 0, y \\ge 0
                    \\end{cases}
                    $$
                    </div>
                    <p>Bạn đã làm rất tốt trong việc chuyển đổi một bài toán thực tế sang ngôn ngữ toán học!</p>`,
                    highlights: { processed: ['p2_labor_A', 'p2_labor_B', 'p2_material_A', 'p2_material_B', 'p2_limit_labor', 'p2_limit_material'] }
                }
            ];

            // --- SCRIPT LOGIC ---
            const slidesContainer = document.getElementById('slides-container');
            const prevBtn = document.getElementById('prevBtn');
            const nextBtn = document.getElementById('nextBtn');
            const slideCounter = document.getElementById('slideCounter');
            const problem1Display = document.getElementById('problem1-statement-display');
            const problem2Display = document.getElementById('problem2-statement-display');
            
            let currentSlide = 0;

            function generateSlides() {
                slidesConfig.forEach((slide, index) => {
                    const slideEl = document.createElement('div');
                    slideEl.className = 'slide';
                    slideEl.id = `slide-${index}`;
                    
                    let contentHTML = `<h2>${slide.title}</h2><div>${slide.content}</div>`;

                    if (slide.isExercise) {
                        contentHTML += `
                        <div class="exercise-buttons">
                            <button class="nav-button hint-button" onclick="toggleHint(${index})">Gợi ý</button>
                            <button class="nav-button" style="background-color: var(--success-color);" onclick="checkAnswers(${index})">Kiểm tra đáp án</button>
                        </div>
                        <div id="feedback-message-${index}" class="feedback-message"></div>`;
                    }
                    
                    slideEl.innerHTML = contentHTML;
                    slidesContainer.appendChild(slideEl);
                });
            }

            function normalizeAnswer(str) {
                if (typeof str !== 'string') return '';
                return str.toLowerCase().replace(/\s+/g, '').replace('->', '');
            }
            
            window.checkAnswers = function(slideIndex) {
                const slide = slidesConfig[slideIndex];
                if (!slide.isExercise) return;
                
                let allCorrect = true;
                const feedbackMsg = document.getElementById(`feedback-message-${slideIndex}`);

                for (const [key, correctAnswer] of Object.entries(slide.answers)) {
                    const inputEl = document.getElementById(key);
                    const radioGroup = document.querySelectorAll(`input[name="${key}"]`);

                    if (radioGroup.length > 0) {
                        const checkedRadio = document.querySelector(`input[name="${key}"]:checked`);
                        radioGroup.forEach(radio => radio.parentElement.classList.remove('correct', 'incorrect'));
                        
                        if (checkedRadio && checkedRadio.value === correctAnswer) {
                            checkedRadio.parentElement.classList.add('correct');
                        } else {
                            if(checkedRadio) checkedRadio.parentElement.classList.add('incorrect');
                            allCorrect = false;
                        }
                    } else if (inputEl) { // Text input
                        const userAnswer = normalizeAnswer(inputEl.value);
                        const normalizedCorrectAnswer = normalizeAnswer(correctAnswer);
                        inputEl.classList.remove('correct', 'incorrect');
                        if (userAnswer === normalizedCorrectAnswer) {
                            inputEl.classList.add('correct');
                        } else {
                            inputEl.classList.add('incorrect');
                            allCorrect = false;
                        }
                    }
                }

                feedbackMsg.style.display = 'block';
                feedbackMsg.classList.remove('success', 'error');
                if (allCorrect) {
                    feedbackMsg.textContent = 'Chính xác! Bạn đã làm rất tốt.';
                    feedbackMsg.classList.add('success');
                } else {
                    feedbackMsg.textContent = 'Có lỗi sai. Hãy kiểm tra lại các phần được tô đỏ.';
                    feedbackMsg.classList.add('error');
                }
            }
            
            window.toggleHint = function(slideIndex) {
                const hintEl = document.getElementById(`hint-${slideIndex + 1}`); // Off-by-one due to array indexing
                 if (hintEl) {
                    hintEl.style.display = hintEl.style.display === 'none' ? 'block' : 'none';
                }
            }

            function updateHighlights() {
                const allSpans = document.querySelectorAll('.problem-statement span');
                allSpans.forEach(span => {
                    span.classList.remove('highlight-pastel', 'processed');
                });
                
                const slideConf = slidesConfig[currentSlide];
                if (!slideConf || !slideConf.highlights) return;

                for (let i = 0; i < currentSlide; i++) {
                    const pastConf = slidesConfig[i];
                    if (pastConf.problem === slideConf.problem && pastConf.highlights) {
                         const allPastHighlights = [
                            ...(pastConf.highlights.current || []),
                            ...(pastConf.highlights.processed || [])
                        ];
                        allPastHighlights.forEach(id => {
                            const el = document.getElementById(id);
                            if (el) el.classList.add('processed');
                        });
                    }
                }
                
                if (slideConf.highlights.current) {
                    slideConf.highlights.current.forEach(id => {
                        const el = document.getElementById(id);
                        if (el) {
                            el.classList.remove('processed');
                            el.classList.add('highlight-pastel');
                        }
                    });
                }
            }

            function showSlide(index) {
                const allSlides = document.querySelectorAll('.slide');
                allSlides.forEach((slide, i) => slide.classList.toggle('active', i === index));

                const currentProblem = slidesConfig[index].problem;
                problem1Display.style.display = (currentProblem === 1) ? 'block' : 'none';
                problem2Display.style.display = (currentProblem === 2) ? 'block' : 'none';

                slideCounter.textContent = `Trang ${index + 1} / ${slidesConfig.length}`;
                prevBtn.disabled = index === 0;
                nextBtn.disabled = index === slidesConfig.length - 1;

                updateHighlights();
                if (window.MathJax && window.MathJax.typeset) {
                    window.MathJax.typeset();
                }
            }
            
            window.updateMath = function() {
                if (window.MathJax && window.MathJax.typeset) {
                    window.MathJax.typeset();
                }
            };

            // Initialize
            generateSlides();
            showSlide(currentSlide);
            
            prevBtn.addEventListener('click', () => {
                if (currentSlide > 0) {
                    currentSlide--;
                    showSlide(currentSlide);
                }
            });

            nextBtn.addEventListener('click', () => {
                if (currentSlide < slidesConfig.length - 1) {
                    currentSlide++;
                    showSlide(currentSlide);
                }
            });
        });
    </script>
</body>
</html>


